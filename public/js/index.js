(()=>{class o{constructor(t){this.canvas=null,this.gl=null,this.clock={oldTime:0,isRunning:!1},this.init(t)}createShader(t,r){if(!this.gl)throw new Error("webgl not initialized");if(r!=="vertex"&&r!=="fragment")throw new Error("invalid shader type");const e=this.gl,i=r==="vertex"?e.VERTEX_SHADER:e.FRAGMENT_SHADER,a=e.createShader(i);return e.shaderSource(a,t),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(alert(e.getShaderInfoLog(a)),null)}createProgram(t,r){if(!this.gl)throw new Error("webgl not initialized");const e=this.gl,i=e.createProgram();return e.attachShader(i,t),e.attachShader(i,r),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)?(e.useProgram(i),i):(alert(e.getProgramInfoLog(i)),null)}createVbo(t,r){if(!this.gl)throw new Error("webgl not initialized");const e=this.gl,i=r||e.STATIC_DRAW,a=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,t,i),e.bindBuffer(e.ARRAY_BUFFER,null),a}createIbo(t){if(!this.gl)throw new Error("webgl not initialized");const r=this.gl,e=r.createBuffer();return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Int16Array(t),r.STATIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),e}setAttribute(t,r,e,i){if(!this.gl)throw new Error("webgl not initialized");const a=this.gl;t.forEach((n,s)=>{a.bindBuffer(a.ARRAY_BUFFER,n),a.enableVertexAttribArray(r[s]),a.vertexAttribPointer(r[s],e[s],a.FLOAT,!1,0,0)}),i&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,i)}setUniform(t,r,e){if(!this.gl)throw new Error("webgl not initialized");const i=this.gl;t.forEach((a,n)=>{const s=e[n];s.includes("Matrix")===!0?i[s](r[n],!1,a):i[s](r[n],a)})}getDeltaTime(){const t=this.clock;if(!t.isRunning)return t.isRunning=!0,t.oldTime=performance.now(),0;const r=performance.now(),e=(r-t.oldTime)/1e3;return t.oldTime=r,e}init(t){if(t instanceof HTMLCanvasElement)this.canvas=t;else if(Object.prototype.toString.call(t)==="[object String]"){const r=document.querySelector(t);r instanceof HTMLCanvasElement&&(this.canvas=r)}if(!this.canvas)throw new Error("invalid argument");if(this.gl=this.canvas.getContext("webgl"),!this.gl)throw new Error("webgl not supported")}}var l=`attribute vec3 position;

void main(){
    gl_Position = vec4(position, 1.0);
    gl_PointSize = 16.0;
}
`,h=`precision mediump float;
uniform float time;

void main(){
  // gl_PointCoord
  gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);

}
`;class g{constructor(){this.webGLUtils=new o(".canvas"),this.canvas=this.webGLUtils.canvas,this.gl=this.webGLUtils.gl,this.program=null,this.time=0,this.positions=[],this.vbo=[],this.attLocation=[],this.attStride=[],this.uniLocation=[],this.uniType=[],this.init()}createProgram(){const t=this.webGLUtils,r=t.createShader(l,"vertex"),e=t.createShader(h,"fragment"),i=t.createProgram(r,e);return i}setAttributes(){const t=this.gl,r=this.webGLUtils;this.positions.push([0,0,0],[-.5,.5,0],[.5,.5,0],[-.5,-.5,0],[.5,-.5,0]),this.vbo=[r.createVbo(new Float32Array(this.positions.flat()))],this.attLocation=[t.getAttribLocation(this.program,"position")],this.attStride=[this.positions[0].length]}setUniforms(){const t=this.gl;this.uniLocation=[t.getUniformLocation(this.program,"time")],this.uniType=["uniform1f"]}setData(){this.setAttributes(),this.setUniforms()}setCanvasSize(){const t=this.gl;this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,t.viewport(0,0,this.canvas.width,this.canvas.height)}setup(){const t=this.gl;if(t.clearColor(.1,.1,.1,1),this.setCanvasSize(),this.program=this.createProgram(),!this.program)throw new Error("program object is not found");this.setData()}resize(){this.setCanvasSize()}bind(){window.addEventListener("resize",this.resize.bind(this))}render(){const t=this.gl,r=this.webGLUtils,e=r.getDeltaTime();this.time+=e,t.clear(t.COLOR_BUFFER_BIT),t.useProgram(this.program),r.setAttribute(this.vbo,this.attLocation,this.attStride),r.setUniform([this.time],this.uniLocation,this.uniType),t.drawArrays(t.POINTS,0,this.positions.length)}animate(){this.render(),requestAnimationFrame(this.animate.bind(this))}init(){this.setup(),this.bind(),this.animate()}}new g;})();
